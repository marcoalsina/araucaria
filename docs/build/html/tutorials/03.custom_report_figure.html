

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Part 3: Creating custom report and figures &mdash; araucaria 0.1.8b
 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 4: Linear combination fitting" href="04.linear_comb_fitting.html" />
    <link rel="prev" title="Part 2: Normalization and background removal" href="02.background_removal.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> araucaria
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01.basics_data_processing.html">Part 1: Basics of data processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.background_removal.html">Part 2: Normalization and background removal</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Part 3: Creating custom report and figures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Retrieving-and-summarizing-the-database">1. Retrieving and summarizing the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Generating-a-custom-report">2. Generating a custom report</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Data-visualization">3. Data visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Saving-a-figure">4. Saving a figure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="04.linear_comb_fitting.html">Part 4: Linear combination fitting</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../main_module.html">Main module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io_module.html">IO module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xas_module.html">XAS module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fit_module.html">Fit module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot_module.html">Plot module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stats_module.html">Statistics module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils_module.html">Utilities module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testdata_module.html">Testdata module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">araucaria</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Part 3: Creating custom report and figures</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/03.custom_report_figure.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Part-3:-Creating-custom-report-and-figures">
<h1>Part 3: Creating custom report and figures<a class="headerlink" href="#Part-3:-Creating-custom-report-and-figures" title="Permalink to this headline">¶</a></h1>
<p><em>by Morgane Desmau &amp; Marco Alsina</em></p>
<p><em>Last update: May 2021</em></p>
<p>This notebook explains the following steps:</p>
<ol class="arabic simple">
<li><p>Generating a custom report.</p></li>
<li><p>Generatiing a custom figure.</p></li>
<li><p>Saving a figure.</p></li>
</ol>
<p><strong>Important:</strong> This tutorial assumes you have succesfully completed the previous tutorials in the series:</p>
<ul class="simple">
<li><p><a class="reference internal" href="01.basics_data_processing.html"><span class="doc">Part 1: Basics of data processing</span></a></p></li>
<li><p><a class="reference internal" href="02.background_removal.html"><span class="doc">Part 2: Normalization and background removal</span></a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># checking version of araucaria and dependencies</span>
<span class="kn">from</span> <span class="nn">araucaria.utils</span> <span class="kn">import</span> <span class="n">get_version</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_version</span><span class="p">(</span><span class="n">dependencies</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Python version      : 3.9.4
Numpy version       : 1.20.3
Scipy version       : 1.6.3
Lmfit version       : 1.0.2
H5py version        : 3.2.1
Matplotlib version  : 3.4.2
Araucaria version   : 0.1.8b
</pre></div></div>
</div>
<div class="section" id="1.-Retrieving-and-summarizing-the-database">
<h2>1. Retrieving and summarizing the database<a class="headerlink" href="#1.-Retrieving-and-summarizing-the-database" title="Permalink to this headline">¶</a></h2>
<p>In this case we will be reading and processing a minerals database measured at the Fe K-edge in the P65 beamline of DESY, Hamburg (data kindly provided by Morgane Desmau):</p>
<ol class="arabic simple">
<li><p>Fe_database.h5</p></li>
</ol>
<p>We will use the <a class="reference internal" href="../testdata_module.html#araucaria.testdata.utils.get_testpath"><span class="std std-ref">get_testpath()</span></a> function to retrieve the filepath to the database and summarize its contents.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>If you prefer to process your own database, just modify the filepath to point to the location of your file.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retrieving filepath</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">araucaria.testdata</span> <span class="kn">import</span> <span class="n">get_testpath</span>
<span class="kn">from</span> <span class="nn">araucaria.io</span> <span class="kn">import</span> <span class="n">summary_hdf5</span>

<span class="n">fpath</span> <span class="o">=</span> <span class="n">get_testpath</span><span class="p">(</span><span class="s1">&#39;Fe_database.h5&#39;</span><span class="p">)</span>

<span class="c1"># summarizing database</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">summary_hdf5</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="n">report</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
========================================
id  dataset                 mode    n
========================================
1   FeIISO4_20K             mu      5
2   Fe_Foil                 mu_ref  5
3   Ferrihydrite_20K        mu      5
4   Goethite_20K            mu      5
5   Goethite_20K_10spectra  mu      10
========================================
</pre></div></div>
</div>
</div>
<div class="section" id="2.-Generating-a-custom-report">
<h2>2. Generating a custom report<a class="headerlink" href="#2.-Generating-a-custom-report" title="Permalink to this headline">¶</a></h2>
<p>Here we will be analyzing the specrtra of Ferrihydrite and Goethite, and store the results in a custom <a class="reference internal" href="../main/main_report.html#araucaria.main.report.Report"><span class="std std-ref">Report</span></a>.</p>
<p>We will first declare the required dictionaries to perform spectral normalization and background removal. This allows access and later modification of the parameters if needed, without changing our code for report generation and plotting.</p>
<p>Note that we also declare a function <code class="docutils literal notranslate"><span class="pre">maxindex()</span></code> to compute the index for the maximum value in an array. We will be using this function to compute the maximum values on dXANES, XANES and <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> spectra.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">argrelextrema</span>

<span class="c1"># name of groups</span>
<span class="n">groupnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Goethite_20K&#39;</span><span class="p">,</span> <span class="s1">&#39;Ferrihydrite_20K&#39;</span><span class="p">)</span>

<span class="c1"># parameters for normalization, background removal, and foward fourrier transform</span>
<span class="n">kw</span>     <span class="o">=</span> <span class="mi">2</span>
<span class="n">win</span>    <span class="o">=</span> <span class="s1">&#39;kaiser&#39;</span>

<span class="n">pre_edge_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pre_range&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">],</span>
                <span class="s1">&#39;post_range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">950</span><span class="p">],</span>
                <span class="s1">&#39;nvict&#39;</span>     <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;nnorm&#39;</span>     <span class="p">:</span> <span class="mi">2</span><span class="p">,}</span>

<span class="n">autobk_kws</span>   <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;k_range&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
                <span class="s1">&#39;kweight&#39;</span>   <span class="p">:</span> <span class="n">kw</span><span class="p">,</span>
                <span class="s1">&#39;rbkg&#39;</span>      <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;win&#39;</span>       <span class="p">:</span> <span class="n">win</span><span class="p">,</span>
                <span class="s1">&#39;dk&#39;</span>        <span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;clamp_hi&#39;</span>  <span class="p">:</span> <span class="mi">35</span><span class="p">,}</span>

<span class="n">ftf_kws</span>      <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;k_range&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
                <span class="s1">&#39;kweight&#39;</span>   <span class="p">:</span> <span class="n">kw</span><span class="p">,</span>
                <span class="s1">&#39;win&#39;</span>       <span class="p">:</span> <span class="n">win</span><span class="p">,}</span>

<span class="k">def</span> <span class="nf">maxindex</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Index of maximum value in an array</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">argrelextrema</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>We now read and process the spectra, while storing the computed records in a <a class="reference internal" href="../main/main_report.html#araucaria.main.report.Report"><span class="std std-ref">Report</span></a>. Several steps are performed in a nested loop:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="../io/io_hdf5.html#araucaria.io.io_hdf5.read_hdf5"><span class="std std-ref">read_hdf5()</span></a> function reads a <a class="reference internal" href="../main/main_group.html#araucaria.main.group.Group"><span class="std std-ref">Group</span></a> from a HDF5 database.</p></li>
<li><p>The <a class="reference internal" href="../xas/xas_normalize.html#araucaria.xas.normalize.find_e0"><span class="std std-ref">find_e0()</span></a> function computes the absorpton threshold (<span class="math notranslate nohighlight">\(E_0\)</span>).</p></li>
<li><p>The <a class="reference internal" href="../xas/xas_normalize.html#araucaria.xas.normalize.pre_edge"><span class="std std-ref">pre_edge()</span></a> function normalizes the spectrum.</p></li>
<li><p>The <a class="reference internal" href="../xas/xas_autobk.html#araucaria.xas.autobk.autobk"><span class="std std-ref">autobk()</span></a> function performs background removal to obtain an EXAFS spectrum.</p></li>
<li><p>The <a class="reference internal" href="../xas/xas_ft.html#araucaria.xas.xasft.xftf"><span class="std std-ref">xftf()</span></a> function performs a fast forward Fourier transform of the EXAFS spectrum.</p></li>
<li><p>The maximum values for the selected spectra are computed.</p></li>
<li><p>The values are added to a <a class="reference internal" href="../main/main_report.html#araucaria.main.report.Report"><span class="std std-ref">Report</span></a>.</p></li>
<li><p>The group is stored in a <a class="reference internal" href="../main/main_collection.html#araucaria.main.collection.Collection"><span class="std std-ref">Collection</span></a>.</p></li>
</ul>
<p>Finally we print a summary of the custom <a class="reference internal" href="../main/main_report.html#araucaria.main.report.Report"><span class="std std-ref">Report</span></a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">araucaria</span> <span class="kn">import</span> <span class="n">Report</span><span class="p">,</span> <span class="n">Collection</span>
<span class="kn">from</span> <span class="nn">araucaria.io</span> <span class="kn">import</span> <span class="n">read_hdf5</span>
<span class="kn">from</span> <span class="nn">araucaria.xas</span> <span class="kn">import</span> <span class="n">find_e0</span><span class="p">,</span> <span class="n">pre_edge</span><span class="p">,</span> <span class="n">autobk</span><span class="p">,</span> <span class="n">xftf</span>

<span class="c1"># initializing the report</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">Report</span><span class="p">()</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sample name&#39;</span><span class="p">,</span> <span class="s1">&#39;e0[eV]&#39;</span><span class="p">,</span> <span class="s1">&#39;Edmax[eV]&#39;</span><span class="p">,</span><span class="s1">&#39;Emax[eV]&#39;</span><span class="p">,</span> <span class="s1">&#39;Rmax[A]&#39;</span><span class="p">]</span>
<span class="n">report</span><span class="o">.</span><span class="n">set_columns</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span>

<span class="c1"># initializing a collection</span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groupnames</span><span class="p">):</span>
    <span class="c1"># reading and processing spectra</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">read_hdf5</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">e0</span>   <span class="o">=</span> <span class="n">find_e0</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;halfedge&#39;</span><span class="p">,</span> <span class="n">pre_edge_kws</span> <span class="o">=</span> <span class="n">pre_edge_kws</span><span class="p">,</span> <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">pre_edge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">e0</span> <span class="o">=</span> <span class="n">e0</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">pre_edge_kws</span><span class="p">)</span>
    <span class="n">autobk</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">autobk_kws</span><span class="p">)</span>
    <span class="n">xftf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">ftf_kws</span><span class="p">)</span>

    <span class="c1"># extracting maximum for dmu, mu, and chi(R)</span>
    <span class="n">deriv_max_index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="n">maxindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">))]</span>
    <span class="n">mu_max_index</span>    <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="n">maxindex</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mu</span><span class="p">)]</span>
    <span class="n">r_max_index</span>     <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">maxindex</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chir_mag</span><span class="p">)]</span>

    <span class="c1"># adding content to the report</span>
    <span class="n">report</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">groupnames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e0</span><span class="p">,</span> <span class="n">deriv_max_index</span><span class="p">,</span> <span class="n">mu_max_index</span><span class="p">,</span> <span class="n">r_max_index</span><span class="p">])</span>

    <span class="c1"># add group to collection</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">report</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
========================================================
Sample name       e0[eV]  Edmax[eV]  Emax[eV]  Rmax[A]
========================================================
Goethite_20K      7125.2  7127.3     7131      1.4726
Ferrihydrite_20K  7124.8  7127.4     7132.6    1.4726
========================================================
</pre></div></div>
</div>
</div>
<div class="section" id="3.-Data-visualization">
<h2>3. Data visualization<a class="headerlink" href="#3.-Data-visualization" title="Permalink to this headline">¶</a></h2>
<p>We can now plot the data stored in the <a class="reference internal" href="../main/main_collection.html#araucaria.main.collection.Collection"><span class="std std-ref">Collection</span></a> along with the computed values.</p>
<p>We use the <a class="reference internal" href="../plot_module.html#araucaria.plot.template.fig_xas_template"><span class="std std-ref">fig_xas_template()</span></a> function to create a <code class="docutils literal notranslate"><span class="pre">Figure</span></code> and <code class="docutils literal notranslate"><span class="pre">axes</span></code> objects with the following attributes:</p>
<ul class="simple">
<li><p>2 by 2 pre-defined panels for dXANES, XANES, EXAFS, and FT-EXAFS spectra.</p></li>
<li><p>A dictionary to specify figure decorators (fig_pars). Note that we can also specifiy a <code class="docutils literal notranslate"><span class="pre">prop_cycle</span></code> dictionary to preset the color of the plots.</p></li>
<li><p>A dictionary to specify general parameters for the figure (fig_kws). These arguments are passed directly to the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> constructor.</p></li>
</ul>
<p>Finally, we access the specific columns of the <a class="reference internal" href="../main/main_report.html#araucaria.main.report.Report"><span class="std std-ref">Report</span></a> through the <a class="reference internal" href="../main/main_report.html#araucaria.main.report.Report.get_cols"><span class="std std-ref">get_cols()</span></a> method. Since data is stored as text, we convert it to <code class="docutils literal notranslate"><span class="pre">float</span></code> before plotting.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">araucaria.plot</span> <span class="kn">import</span> <span class="n">fig_xas_template</span>

<span class="c1"># figure parameters</span>
<span class="n">k_edge</span>   <span class="o">=</span> <span class="mi">7112</span>
<span class="n">fig_kws</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;figsize&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)}</span>  <span class="c1"># figure size in inches</span>
<span class="n">fig_pars</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;e_range&#39;</span>  <span class="p">:</span> <span class="p">(</span><span class="n">k_edge</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="n">k_edge</span><span class="o">+</span><span class="mi">85</span><span class="p">),</span>
           <span class="s1">&#39;k_range&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">],</span>
           <span class="s1">&#39;k_weight&#39;</span>  <span class="p">:</span> <span class="n">kw</span><span class="p">,</span>
           <span class="s1">&#39;k_ticks&#39;</span>   <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span>
           <span class="s1">&#39;r_range&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
           <span class="s1">&#39;r_ticks&#39;</span>   <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
           <span class="s1">&#39;prop_cycle&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;color&#39;</span>     <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span>
                           <span class="s1">&#39;linewidth&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span>    <span class="p">,</span> <span class="mf">1.5</span>  <span class="p">],}]</span>
           <span class="p">}</span>

<span class="c1"># initializing figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fig_xas_template</span><span class="p">(</span><span class="n">panels</span> <span class="o">=</span> <span class="s1">&#39;dx/er&#39;</span><span class="p">,</span> <span class="n">fig_pars</span> <span class="o">=</span> <span class="n">fig_pars</span><span class="p">,</span> <span class="o">**</span><span class="n">fig_kws</span><span class="p">)</span>

<span class="c1"># extracting values from the report</span>
<span class="n">dmu_max</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get_cols</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Edmax[eV]&#39;</span><span class="p">])</span>
<span class="n">mu_max</span>  <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get_cols</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Emax[eV]&#39;</span><span class="p">])</span>
<span class="n">r_max</span>   <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get_cols</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rmax[A]&#39;</span><span class="p">])</span>

<span class="c1"># plotting data</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groupnames</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># plotting spectra</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="n">kw</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">chir_mag</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="c1"># plotting auxiliary lines</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dmu_max</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">mu_max</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r_max</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_03.custom_report_figure_10_0.png" src="../_images/tutorials_03.custom_report_figure_10_0.png" />
</div>
</div>
<p>The <a class="reference internal" href="../plot_module.html#araucaria.plot.template.fig_xas_template"><span class="std std-ref">fig_xas_template()</span></a> function is quite flexible to generate figure templates. Here we show the creation of panels in a single file to plot and annotate offset spectra.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># figure parameters</span>
<span class="n">steps</span>    <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="n">align</span>    <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
<span class="n">fsize</span>    <span class="o">=</span> <span class="mi">10</span>
<span class="n">fig_kws</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;figsize&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">)}</span>
<span class="n">fig_pars</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;e_range&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">k_edge</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">k_edge</span><span class="o">+</span><span class="mi">130</span><span class="p">),</span>
            <span class="s1">&#39;e_ticks&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="n">k_edge</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">k_edge</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">k_edge</span><span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="n">k_edge</span><span class="o">+</span><span class="mi">90</span><span class="p">,</span> <span class="n">k_edge</span><span class="o">+</span><span class="mi">130</span><span class="p">],</span>
            <span class="s1">&#39;k_range&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">16.3</span><span class="p">],</span>
            <span class="s1">&#39;k_weight&#39;</span>  <span class="p">:</span> <span class="n">kw</span><span class="p">,</span>
            <span class="s1">&#39;k_ticks&#39;</span>   <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span>
            <span class="s1">&#39;r_range&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
            <span class="s1">&#39;r_ticks&#39;</span>   <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
            <span class="s1">&#39;prop_cycle&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;color&#39;</span>     <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;linewidth&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span>    <span class="p">,</span> <span class="mf">1.5</span>  <span class="p">],}]</span>
           <span class="p">}</span>

<span class="c1"># initializing figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fig_xas_template</span><span class="p">(</span><span class="n">panels</span> <span class="o">=</span> <span class="s1">&#39;xder&#39;</span><span class="p">,</span> <span class="n">fig_pars</span> <span class="o">=</span> <span class="n">fig_pars</span><span class="p">,</span> <span class="o">**</span><span class="n">fig_kws</span><span class="p">)</span>

<span class="c1"># plotting data</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groupnames</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># plotting spectra</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy</span><span class="p">),</span>
                 <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">chir_mag</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="c1"># annotating spectra</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7240</span><span class="p">,</span> <span class="mf">1.15</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7240</span><span class="p">,</span> <span class="mf">0.05</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">16</span>  <span class="p">,</span> <span class="mf">0.8</span>  <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">7.9</span> <span class="p">,</span> <span class="mf">0.5</span>  <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">steps</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_03.custom_report_figure_12_0.png" src="../_images/tutorials_03.custom_report_figure_12_0.png" />
</div>
</div>
</div>
<div class="section" id="4.-Saving-a-figure">
<h2>4. Saving a figure<a class="headerlink" href="#4.-Saving-a-figure" title="Permalink to this headline">¶</a></h2>
<p>Figures in <code class="docutils literal notranslate"><span class="pre">araucaria</span></code> are produced with the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library. Thus, we can save the resulting <code class="docutils literal notranslate"><span class="pre">Figure</span></code> object with the <code class="docutils literal notranslate"><span class="pre">savefig</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">figpath</span> <span class="o">=</span> <span class="s1">&#39;figure.pdf&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figpath</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Figure saved in </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">figpath</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Figure saved in figure.pdf
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="04.linear_comb_fitting.html" class="btn btn-neutral float-right" title="Part 4: Linear combination fitting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="02.background_removal.html" class="btn btn-neutral float-left" title="Part 2: Normalization and background removal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2021, Marco A. Alsina.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>